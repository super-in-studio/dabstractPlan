<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-c672802d-071d-4b4e-90a3-ae6273d7c47f"></attachment><p>1.找出当前那些sql运行慢的语句</p><p><br></p><pre class="ql-syntax" spellcheck="false">select id, db, user, host, command, time, state, info
from information_schema.processlist
where command != 'Sleep' and time &gt; 2*60
order by time desc ;
</pre><p><br></p><p><br></p><ol><li>通过&nbsp;<code style="color: rgb(199, 37, 78); background-color: rgb(249, 242, 244);">show status</code>&nbsp;命令了解各种sql的执行频率</li></ol><p>show status like 'Com_%';</p><p><br></p><ol><li>定位执行效率较低的sql语句</li><li>通过<code style="color: rgb(199, 37, 78); background-color: rgb(249, 242, 244);">explain</code>分析低效sql的执行计划</li><li>通过&nbsp;<code style="color: rgb(199, 37, 78); background-color: rgb(249, 242, 244);">show profile</code>&nbsp;分析sql （<span style="color: rgb(77, 77, 77);">5.0.37 之后的特性</span>）</li></ol><p>show profiles ;</p><p>show profile FOR QUERY 77 ;</p><p><br></p><p>4 通过trace分析 优化器 如何选择执行计划 （待查看）</p><p>1.SHOW VARIABLES LIKE 'optimizer_trace' ;</p><p>2.打开optimizer trace功能 (默认情况下它是关闭的):</p><p><br></p><ol><li class="ql-indent-1">SET optimizer_trace="enabled=on";</li><li>这里输入你自己的查询语句</li><li class="ql-indent-1">SELECT ...;</li><li>从OPTIMIZER_TRACE表中查看上一个查询的优化过程</li><li class="ql-indent-1">SELECT * FROM information_schema.OPTIMIZER_TRACE;</li><li>可能你还要观察其他语句执行的优化过程，重复上边的第2、3步</li><li class="ql-indent-1">...</li><li>当你停止查看语句的优化过程时，把optimizer trace功能关闭</li><li class="ql-indent-1">SET optimizer_trace="enabled=off";</li></ol><blockquote>otpimzer trace功能的作用和优化的大致阶段</blockquote><p><br></p><p><br></p><p><br></p>